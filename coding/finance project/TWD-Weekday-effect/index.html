<!DOCTYPE html><html lang="en" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="USDTWD 的星期因素探討" /><meta name="author" content="Lung Hung Lin" /><meta property="og:locale" content="en" /><meta name="description" content="本文 pdf 連結 程式碼 摘要 一、前言 二、資料處理 三、實證結果 參考文獻" /><meta property="og:description" content="本文 pdf 連結 程式碼 摘要 一、前言 二、資料處理 三、實證結果 參考文獻" /><link rel="canonical" href="https://github.com/LLH07/LLH07.github.io/coding/finance%20project/TWD-Weekday-effect/" /><meta property="og:url" content="https://github.com/LLH07/LLH07.github.io/coding/finance%20project/TWD-Weekday-effect/" /><meta property="og:site_name" content="財金蛋白" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-31T14:28:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="USDTWD 的星期因素探討" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Lung Hung Lin" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Lung Hung Lin"},"description":"本文 pdf 連結 程式碼 摘要 一、前言 二、資料處理 三、實證結果 參考文獻","url":"https://github.com/LLH07/LLH07.github.io/coding/finance%20project/TWD-Weekday-effect/","@type":"BlogPosting","headline":"USDTWD 的星期因素探討","dateModified":"2023-02-01T22:10:08+08:00","datePublished":"2023-01-31T14:28:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://github.com/LLH07/LLH07.github.io/coding/finance%20project/TWD-Weekday-effect/"},"@context":"https://schema.org"}</script><title>USDTWD 的星期因素探討 | 財金蛋白</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="財金蛋白"><meta name="application-name" content="財金蛋白"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://raw.githubusercontent.com/LLH07/LLH07.github.io/main/mstile-92x92.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">財金蛋白</a></div><div class="site-subtitle font-italic">投資、程式、人生</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/GritFX/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>GRITFX</span> </a><li class="nav-item"> <a href="/Code/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>CODE</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/LLH07" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['lunghung.llh.blog','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>USDTWD 的星期因素探討</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>USDTWD 的星期因素探討</h1><div class="post-meta text-muted"><div> By <em> <a href="https://www.linkedin.com/in/lung-hung-blair-lin-645a85194/">Lung Hung Lin</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2023-01-31 14:28:00 +0800" data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 31, 2023, 2:28 PM +0800" >Jan 31, 2023</em> </span> <span> Updated <em class="timeago" date="2023-02-01 22:10:08 +0800 " data-toggle="tooltip" data-placement="bottom" title="Wed, Feb 1, 2023, 10:10 PM +0800" >Feb 1, 2023</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2515 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><p><a href="https://drive.google.com/file/d/17jDSw-LyaEA8VIltt5PvMbnhGMPL2skK/view?usp=share_link" target="_blank">本文 pdf 連結</a></p><ul><li><a href="#程式碼">程式碼</a><li><a href="#摘要">摘要</a><li><a href="#一前言">一、前言</a><li><a href="#二資料處理">二、資料處理</a><li><a href="#三實證結果">三、實證結果</a><li><a href="#參考文獻">參考文獻</a></ul><h2 id="程式碼">程式碼<a href="#程式碼" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">dataCollect</span><span class="p">(</span><span class="n">twd</span><span class="p">):</span>
    <span class="n">twd</span><span class="p">.</span><span class="n">Taiwan_Date</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">Taiwan_Date</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">dt</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="s">"%Y/%m/%d"</span><span class="p">))</span>
    <span class="n">twd</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">Taiwan_Date</span>
    <span class="k">del</span> <span class="n">twd</span><span class="p">[</span><span class="s">'Taiwan_Date'</span><span class="p">]</span>
    <span class="c1"># convert datetime string to the week of the day
</span>    <span class="n">twd</span><span class="p">[</span><span class="s">'Weekday'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">'%a'</span><span class="p">)</span>
    <span class="n">twd</span> <span class="o">=</span> <span class="n">twd</span><span class="p">[</span> <span class="p">(</span><span class="n">twd</span><span class="p">.</span><span class="n">index</span> <span class="o">&gt;</span> <span class="n">dt</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">twd</span><span class="p">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="n">dt</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span> <span class="p">]</span> 
    <span class="n">twd</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">"Taiwan_CCY"</span><span class="p">:</span> <span class="s">"TWD"</span><span class="p">})</span>
    <span class="n">twd</span> <span class="o">=</span> <span class="n">twd</span><span class="p">[</span> <span class="p">[</span><span class="s">'Weekday'</span><span class="p">,</span> <span class="s">'TWD'</span><span class="p">]]</span> <span class="c1"># only need weeday and spot data
</span>    <span class="k">return</span> <span class="n">twd</span>

<span class="k">def</span> <span class="nf">calReturn</span><span class="p">(</span><span class="n">twd</span><span class="p">):</span>
    <span class="c1"># use previous day's data and today's data to calculate daily return of USDTWD
</span>    <span class="n">twd</span><span class="p">[</span><span class="s">'TWD_prev'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">[</span><span class="s">'TWD'</span><span class="p">].</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">twd</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">twd</span><span class="p">[</span><span class="s">'Daily_ret'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">log</span><span class="p">(</span><span class="n">twd</span><span class="p">[</span><span class="s">'TWD'</span><span class="p">]</span><span class="o">/</span><span class="n">twd</span><span class="p">[</span><span class="s">'TWD_prev'</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">twd</span> <span class="o">=</span> <span class="n">twd</span><span class="p">[</span> <span class="n">twd</span><span class="p">[</span><span class="s">'Daily_ret'</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">twd</span>

<span class="c1"># basic statistics
</span><span class="k">def</span> <span class="nf">descriptiveStat</span><span class="p">(</span><span class="n">twd</span><span class="p">):</span>
    <span class="n">statDict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">statDict</span><span class="p">[</span><span class="s">'Max'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">.</span><span class="nb">max</span><span class="p">()</span>
    <span class="n">statDict</span><span class="p">[</span><span class="s">'MaxPriceDate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">twd</span><span class="p">.</span><span class="n">TWD</span> <span class="o">==</span> <span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">.</span><span class="nb">max</span><span class="p">()].</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the date when UDSTWD is the highest
</span>    <span class="n">statDict</span><span class="p">[</span><span class="s">'Min'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">.</span><span class="nb">min</span><span class="p">()</span> 
    <span class="n">statDict</span><span class="p">[</span><span class="s">'MinPriceDate'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">twd</span><span class="p">.</span><span class="n">TWD</span> <span class="o">==</span> <span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">.</span><span class="nb">min</span><span class="p">()].</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># get the date when UDSTWD is the lowest
</span>    <span class="n">statDict</span><span class="p">[</span><span class="s">'Median'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">.</span><span class="n">median</span><span class="p">()</span>
    <span class="n">statDict</span><span class="p">[</span><span class="s">'Mean'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">statDict</span><span class="p">[</span><span class="s">'Std'</span><span class="p">]</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">.</span><span class="n">std</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'The descriptive Statistics of the sample: '</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">statDict</span>

<span class="c1"># calculate higher moments of each workday
</span><span class="k">def</span> <span class="nf">calHighMoments</span><span class="p">(</span><span class="n">twd</span><span class="p">):</span>
    <span class="n">weekdays</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Mon'</span><span class="p">,</span> <span class="s">'Tue'</span><span class="p">,</span> <span class="s">'Wed'</span><span class="p">,</span> <span class="s">'Thu'</span><span class="p">,</span> <span class="s">'Fri'</span><span class="p">]</span>
    <span class="n">stat_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">weekdays</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weekdays</span><span class="p">:</span>
        <span class="n">tmpDict</span> <span class="o">=</span> <span class="p">{}</span> <span class="c1"># tmp dictionary to store data
</span>        <span class="n">tmpDf</span> <span class="o">=</span> <span class="n">twd</span><span class="p">[</span><span class="n">twd</span><span class="p">.</span><span class="n">Weekday</span> <span class="o">==</span> <span class="n">i</span><span class="p">]</span> <span class="c1"># filter each workday
</span>    
        <span class="n">n</span> <span class="o">=</span> <span class="n">tmpDf</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># this is the sample size
</span>        <span class="n">tmpMean</span> <span class="o">=</span> <span class="n">tmpDf</span><span class="p">.</span><span class="n">Daily_ret</span><span class="p">.</span><span class="n">mean</span><span class="p">()</span> <span class="c1"># mean of each workday
</span>        <span class="n">tmpStd</span> <span class="o">=</span> <span class="n">tmpDf</span><span class="p">.</span><span class="n">Daily_ret</span><span class="p">.</span><span class="n">std</span><span class="p">()</span> <span class="c1"># standard deviation of each workday
</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tmpDf</span><span class="p">.</span><span class="n">Daily_ret</span><span class="p">:</span> <span class="c1"># there is a summation in the formula of Skewness and Kurtosis 
</span>            <span class="n">power3</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="c1"># summation for skewness
</span>            <span class="n">power4</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span> <span class="c1"># summation for kurtosis
</span>            <span class="n">power3</span> <span class="o">=</span> <span class="n">power3</span> <span class="o">+</span> <span class="p">(</span> <span class="p">((</span><span class="n">j</span> <span class="o">-</span> <span class="n">tmpMean</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">tmpStd</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
            <span class="n">power4</span> <span class="o">=</span> <span class="n">power4</span> <span class="o">+</span> <span class="p">((</span><span class="n">j</span> <span class="o">-</span> <span class="n">tmpMean</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>

        <span class="c1"># formulas for skewness and kurtosis
</span>        <span class="n">tmpSk</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="n">power3</span>
        <span class="n">tmpKur</span> <span class="o">=</span> <span class="n">power4</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">tmpStd</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span>

        <span class="n">tmpDict</span><span class="p">[</span><span class="s">'Mean'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpMean</span>
        <span class="n">tmpDict</span><span class="p">[</span><span class="s">'Std'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpStd</span>
        <span class="n">tmpDict</span><span class="p">[</span><span class="s">'Sk'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpSk</span>
        <span class="n">tmpDict</span><span class="p">[</span><span class="s">'Kur'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmpKur</span>
        <span class="n">stat_df</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">tmpDict</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s">'Mean'</span><span class="p">,</span> <span class="s">'Std'</span><span class="p">,</span> <span class="s">'Sk'</span><span class="p">,</span> <span class="s">'Kur'</span><span class="p">])</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'Higher moment statistics of the sample: '</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stat_df</span>

<span class="c1"># plot the time series data of USDTWD data
</span><span class="k">def</span> <span class="nf">plotTS</span><span class="p">(</span><span class="n">twd</span><span class="p">):</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">twd</span><span class="p">.</span><span class="n">TWD</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"2009.03 to 2022.12 USDTWD Mid Price"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"Year"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"USDTWD"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="n">close</span><span class="p">()</span> <span class="c1"># close the figure
</span>
<span class="c1"># plot the histogram of each workday's daily return
</span><span class="k">def</span> <span class="nf">plotHist</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="n">style</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s">'together'</span><span class="p">:</span> <span class="c1"># plot the histogram together
</span>        <span class="c1"># 分 30 個箱子 (bins=30)
</span>        <span class="n">twd</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Weekday'</span><span class="p">)[</span><span class="s">'Daily_ret'</span><span class="p">].</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># change the legend order to: Mon, Tue, Wed...
</span>        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">gca</span><span class="p">().</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
        <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">legend</span><span class="p">([</span><span class="n">handles</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order</span><span class="p">],</span> <span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order</span><span class="p">])</span>

        <span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">"%"</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">"Count"</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="s">"Daily Return Histogram"</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
        

    <span class="k">if</span> <span class="n">style</span> <span class="o">==</span> <span class="s">'seperate'</span><span class="p">:</span> <span class="c1"># plot each workday's daily return histogram in different plot
</span>        <span class="n">g</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Weekday'</span><span class="p">)[</span><span class="s">'Daily_ret'</span><span class="p">]</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">g</span><span class="p">.</span><span class="n">ngroups</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">wd</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">d</span><span class="p">.</span><span class="n">plot</span><span class="p">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s">'%'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'Count'</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="n">wd</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="s">'r'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># denote the mean in RED line
</span>            <span class="n">ax</span><span class="p">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">median</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="s">'y'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s">'--'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># denote the median in YELLOW line
</span>            <span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'%'</span><span class="p">)</span>
            <span class="n">ax</span><span class="p">.</span><span class="n">legend</span><span class="p">().</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">fig</span><span class="p">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">checkDist</span><span class="p">(</span><span class="n">twd</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">twd</span><span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'Weekday'</span><span class="p">)[</span><span class="s">'Daily_ret'</span><span class="p">].</span><span class="nb">apply</span><span class="p">(</span><span class="n">stats</span><span class="p">.</span><span class="n">kstest</span><span class="p">,</span> <span class="n">cdf</span><span class="o">=</span><span class="s">'norm'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">'The t-statistics (first value) and the p-value (second value) of the sample: '</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g</span>

<span class="k">def</span> <span class="nf">testWeekdaySign</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="n">wd</span><span class="p">):</span>
    <span class="n">testRes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">weekdays</span> <span class="o">=</span> <span class="p">[</span><span class="s">'Mon'</span><span class="p">,</span> <span class="s">'Tue'</span><span class="p">,</span> <span class="s">'Wed'</span><span class="p">,</span> <span class="s">'Thu'</span><span class="p">,</span> <span class="s">'Fri'</span><span class="p">]</span>
    <span class="n">firstSample</span> <span class="o">=</span> <span class="n">twd</span><span class="p">[</span><span class="n">twd</span><span class="p">.</span><span class="n">Weekday</span> <span class="o">==</span> <span class="n">wd</span><span class="p">][</span><span class="s">'Daily_ret'</span><span class="p">]</span> <span class="c1"># get first sample and we will compare it with four other workdays
</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weekdays</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">wd</span><span class="p">:</span> <span class="c1"># if we get the first sample, we should ignore it
</span>            <span class="k">continue</span>
        <span class="n">secondSample</span> <span class="o">=</span> <span class="n">twd</span><span class="p">[</span><span class="n">twd</span><span class="p">.</span><span class="n">Weekday</span> <span class="o">==</span> <span class="n">i</span><span class="p">][</span><span class="s">'Daily_ret'</span><span class="p">]</span>
        <span class="n">testRes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="p">.</span><span class="n">ks_2samp</span><span class="p">(</span><span class="n">firstSample</span><span class="p">,</span> <span class="n">secondSample</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># Kolmogorov-Smirnov test
</span>    <span class="k">return</span> <span class="n">testRes</span>
    

<span class="k">def</span> <span class="nf">__init__</span><span class="p">():</span>
    <span class="c1"># read the data and rearrange by date
</span>    <span class="n">twd</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'twdSpot.csv'</span><span class="p">).</span><span class="n">dropna</span><span class="p">().</span><span class="n">iloc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">twd</span> <span class="o">=</span> <span class="n">dataCollect</span><span class="p">(</span><span class="n">twd</span><span class="p">)</span>
    <span class="n">twd</span> <span class="o">=</span> <span class="n">calReturn</span><span class="p">(</span><span class="n">twd</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">'Complete dataframe: '</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">twd</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="n">descriptiveStat</span><span class="p">(</span><span class="n">twd</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>


    <span class="c1"># plot the USDTWD time series
</span>    <span class="n">plotTS</span><span class="p">(</span><span class="n">twd</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>

    <span class="c1"># calculate skewness and kurtosis and plot them
</span>    <span class="k">print</span><span class="p">(</span><span class="n">calHighMoments</span><span class="p">(</span><span class="n">twd</span><span class="p">))</span>
    <span class="n">plotHist</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="s">'together'</span><span class="p">)</span>
    <span class="n">plotHist</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="s">'seperate'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>

    <span class="c1"># check if the whole sample comes from normal distribution
</span>    <span class="k">print</span><span class="p">(</span><span class="n">checkDist</span><span class="p">(</span><span class="n">twd</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">''</span><span class="p">)</span>

    <span class="c1"># check if each workday comes from the same distribution of other workday
</span>    <span class="k">print</span><span class="p">(</span><span class="s">'The p-value of whether the two samples come from the same distribution: '</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">testWeekdaySign</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="s">'Mon'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">testWeekdaySign</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="s">'Tue'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">testWeekdaySign</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="s">'Wed'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">testWeekdaySign</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="s">'Thu'</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">testWeekdaySign</span><span class="p">(</span><span class="n">twd</span><span class="p">,</span> <span class="s">'Fri'</span><span class="p">))</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">__init__</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="摘要">摘要<a href="#摘要" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>本文主要探討台幣外匯市場之每日報酬是否可被星期因素 (day-of-the-week effect)，實證結果各工作日 (星期一至星期五)與其他工作日差異不明顯，未能有足夠信心拒絕「兩樣本來自相同分配」的虛無假設。這與本文參考的論文結果不一致，一個可能是本文使用的是美國開啟量化寬鬆 (Quantitative easing)後之匯率資料，故市場對貨幣價值的評價不同，進而導致在現代匯率市場中星期因素不明顯。</p><h2 id="一前言">一、前言<a href="#一前言" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>在證券市場中，星期因素 (day-of-the-week effect)被許多學者研究，該理論指出，投資者在星期五買入證券所獲得的報酬高於在星期一買入，原因是證券市場的交割日 (Settlement Date)制度。以台灣為例，買入證券當稱為交易日 (Trade Day)，但交割買入證券的日期是在交易日的兩天後 (Settlement Date)，由於周末兩天為休假日，故在星期五買入證券時，需要等到下周二才能交割，投資者有多餘兩天將交割款項用於其他市場，例如: 隔夜拆款市場，賺取較高的報酬。</p><p>星期因素不僅出現在證券市場，在交易量更為龐大的外匯市場也曾出現，McFarland, Pettit, and Sung (1982)發現對美國投資者來說，在星期一與星期三投資外幣的報酬較高、星期四與星期五的報酬則偏低，Gordon Tang (1998)提出假設，認為即使是同一貨幣對，在不同個工作天 (weekday)的每日報酬並非來自同樣的分配，本文即使用 USDTWD 數據檢驗。</p><h2 id="二資料處理">二、資料處理<a href="#二資料處理" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>本篇報告使用路透 (Reuters)提供的 USDTWD 每日即期收盤價，並使用中價，資料區間為 1990 年三月至 2022 年十二月。報酬率的定義為 $ln⁡(P_t-P_{t-1} )-1$，其中 $P_t$ 為當日收盤中價、 $P_{t-1}$ 為前一交易日收盤中價。圖一為資料區間內 USDTWD 歷史走勢，可以看到在此期間 USDTWD 在 27.5 至 35.5 之間波動，最高價位 35.168 出現在 2009 年 3 月 3 日，為台幣區間低點，最低價位 27.554 則出現在 2022 年 1 月 18 日，當時在 Fed 持續放出鴿派訊息表明不升息下讓台幣大漲。整個區間 USDTWD 平均匯價為 30.426，標準差為 1.393，敘述型統計資料整理如下表一。</p><p>表一</p><div class="table-wrapper"><table><thead><tr><th>USDTWD<th>值<th>日期<tbody><tr><td>最大值 (台幣相對美元最弱)<td>35.168<td>2009-03-03<tr><td>最小值 (台幣相對美元最強)<td>27.554<td>2022-01-18<tr><td>中位數<td>30.241<td> <tr><td>平均數<td>30.426<td> <tr><td>標準差<td>1.393<td> </table></div><p>圖一</p><p><img data-src="https://lh3.googleusercontent.com/pw/AMWts8BHSVVqwBIy6I5Us7Ww6YuBmrGUDVt-Y_fXGOyaVuPJsHzufXESCOarG3LSvPUfAOdh4AN_i63oThwgXaEgm0ZCgwqMIW5B_CNEqo9MGsAWA1wsdfPedZKCPcZtl_3dUpilSVZj6cuS7cUg12EKvF6a=w382-h278-no?authuser=0" alt="pic1" data-proofer-ignore></p><h2 id="三實證結果">三、實證結果<a href="#三實證結果" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>圖二則為星期一至星期五每日報酬的直方圖，可以看到多數的日報酬介於 -1% 至 1% 區間，極端值也在 -2% 至 1.5% 之內。</p><p>圖二</p><p><img data-src="https://lh3.googleusercontent.com/pw/AMWts8BKQwC49kjqxKVMwUHDkE9gDe3z6fWUgPvMRBSKNRBdnqHeQuiSrQDCkXGmHhg0HkAhz0n0GdnUQOox1cNfaI_08Gs-nd0HYPEcNGcQ4sOzrNylTL0s4VKaOa7f5YJwcskNVxvFQoWtYMj_ecJ4yhiu=w389-h278-no?authuser=0" alt="pic2" data-proofer-ignore></p><p>表二為依照星期區分的統計值，除了一般的均值及標準差外，另外加入三階動差-偏態 (skewness)與四階動差-峰態 (Kurtosis)。偏態讓我們得以檢測資料分布是否偏向某一方，其公式為:</p>\[Skewness= \frac{n}{(n-1)(n-2)}×∑_{i=1}^n\frac{(x_i-\bar x)^3}{s^3}\]<p>其中 $n$ 為資料個數、$x$ 為 USDTWD 每日報酬、$\bar x$ 為資料區間內 USDTWD 每日報酬的平均值、$s$ 為資料區間內 USDTWD 每日報酬的標準差。通常我們認為只要偏態值不等於 0，即視為有偏態傾向，若資料的平均數大於中位數，則資料為右偏 (right-skewed)，反之，若資料的平均數小於中位數，則資料為左偏 (right-skewed)。</p><p>峰態用來衡量手中資料與常態分布相比是較為高峻或是平坦，通常認為若峰態不等於 0 即視為有偏態，大於 0 代表手中資料較常態分配來的高瘦、小於 0 代表較常態分配來的低寬。峰態的公式如下:</p>\[Kurtosis=\frac{1}{(n-1)×s^4}×∑_{i=1}^n(x_i-\bar x)^4\]<p>表二</p><div class="table-wrapper"><table><thead><tr><th>星期一<th>星期二<th>星期三<th>星期四<th>星期五<th> <tbody><tr><td>平均數<td>-0.013742<td>0.017944<td>0.001231<td>-0.008164<td>-0.015501<tr><td>標準差<td>0.257144<td>0.291845<td>0.225287<td>0.235711<td>0.280908<tr><td>偏態<td>0.000961<td>-0.000045<td>0.000003<td>0.000423<td>-0.000005<tr><td>峰態<td>0.000840<td>0.000014<td>0.000000<td>0.000282<td>0.000000</table></div><p>由表二可以看出，星期一的平均報酬率最大，平均報酬接近 2%，報酬最低者為星期五，平均報酬為 -1.5%。報酬標準差則大致相同，不管在哪一天交易，投資者均面對約 22 至 29% 的波動。偏態與峰態則不明顯，但大致來說，USDTWD 各工作的報酬較標準常態分佈高瘦 (峰態不小於 0)。圖三顯示各工作日的歷史報酬分布，紅色虛線為報酬平均數、黃色虛線為報酬中位數，兩者在各工作日中幾乎相同，顯示資料區間內的偏度不明顯。</p><p>圖三 <img data-src="https://lh3.googleusercontent.com/pw/AMWts8D9ZGeifEjK10MxBeXIBslKOOXp_JyQyGrUn7Uj8dfnGf1V796lGWXDFdN7QhlXaI0Bfc9q3CKRjZJts10LCNaNrVByRQwVC3tWyhzwIQ2B4opgtfgHw143KVvdfWnXwDKgSPrUj7hNBQhJfO-0OnVa=s893-no?authuser=0" alt="pic3" data-proofer-ignore></p><p>然而，有必要對資料分布做更精確的檢定，在此使用 Kolmogorov-Smirnov 檢定來檢測各工作日報酬的分布是否符合常態分布，Kolmogorov-Smirnov 檢定是一種無母數檢定法 (Non-parametric test)，用於不確定樣本是何種分配的情況。將每個工作日的每日報酬作為一個樣本，並依序檢驗其與其他工作日樣本是否來自同樣的母體分配，若 p-value 小於 0.05，則拒絕雙尾檢定的虛無假設: 「兩樣本來自相同母體分配」，表四為各工作日對其他工作日之 Kolmogorov-Smirnov 檢定的 p 值，粗體表示在 5 % 的信心水準下無法被拒絕的情況。</p><p>由表四可以看到，除了同工作日與同工作日無須檢定外，均無足夠信心拒絕「兩樣本來自相同分配」的虛無假設，顯示星期一與星期五對其他工作日基本上來自相同分配，這與 Gordon Tang 的檢驗結果不一致。</p><p>表四 <img data-src="https://lh3.googleusercontent.com/pw/AMWts8ATST56brc1cyxWSOUdRKEHIasHe0Svy17h_7Ngfy5VXCIM6USuPI1OngwVAB4Wl7jLGBYKc0tx2epp89lZDRQtThFLDjetX1iv1IH4j3dgSScziGSCQ0KuAw5w43r5OBMheV1qw48-9tniQl7xDDrU=w727-h227-no?authuser=0" alt="pic4" data-proofer-ignore></p><h2 id="參考文獻">參考文獻<a href="#參考文獻" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Gordon Tang, 1998. “Weekly Pattern of Exchange Rate Risks: Evidence from Ten Asian-Pacific Currencies,” Asia-Pacific Financial Markets, Springer;Japanese Association of Financial Economics and Engineering, vol. 5(3), pages 261-274, November.</p><p>McFarland, J., Pettit, R., and Sung, S. (1982), The distribution of foreign exchange price changes: Trading day effects and risk measurement, J. Finance 37, 693–715.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/coding/'>Coding</a>, <a href='/categories/finance-project/'>Finance project</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/backtest/" class="post-tag no-text-decoration" >Backtest</a> <a href="/tags/seasonality/" class="post-tag no-text-decoration" >Seasonality</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=USDTWD 的星期因素探討 - 財金蛋白&url=https://github.com/LLH07/LLH07.github.io/coding/finance%20project/TWD-Weekday-effect/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=USDTWD 的星期因素探討 - 財金蛋白&u=https://github.com/LLH07/LLH07.github.io/coding/finance%20project/TWD-Weekday-effect/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=USDTWD 的星期因素探討 - 財金蛋白&url=https://github.com/LLH07/LLH07.github.io/coding/finance%20project/TWD-Weekday-effect/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/%E9%81%B8%E6%93%87%E6%AC%8A/%E5%A4%96%E5%8C%AF/%E5%A4%96%E5%8C%AF%E9%81%B8%E6%93%87%E6%AC%8A%E7%9A%84delta%E6%8E%A8%E5%B0%8E/">外匯選擇權的delta推導 (I)</a><li><a href="/python/%E8%87%AA%E5%8B%95%E5%8C%96/%E8%87%AA%E5%8B%95%E6%8A%93%E5%8F%96%E6%9C%9F%E4%BA%A4%E6%89%80%E9%81%B8%E6%93%87%E6%AC%8A%E8%B3%87%E6%96%99/">用 Python 自動抓取期交所選擇權數據</a><li><a href="/coding/finance%20project/TWD-Weekday-effect/">USDTWD 的星期因素探討</a><li><a href="/macroeconomics/fx/GritFX-VOL52/">GritFX Vol. 52 (Eye On FED)</a><li><a href="/macroeconomics/fx/GritFX-VOL48/">GritFX Vol. 48 (long GBPUSD、short EURUSD)</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/gritfx/">GritFX</a> <a class="post-tag" href="/tags/backtest/">Backtest</a> <a class="post-tag" href="/tags/webscrape/">WebScrape</a> <a class="post-tag" href="/tags/econometrics/">Econometrics</a> <a class="post-tag" href="/tags/factor-investing/">Factor Investing</a> <a class="post-tag" href="/tags/jupyter-notebook/">Jupyter Notebook</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/seasonality/">Seasonality</a> <a class="post-tag" href="/tags/tabf/">TABF</a> <a class="post-tag" href="/tags/visualization/">Visualization</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/coding/finance%20project/daxPortfolio/"><div class="card-body"> <em class="timeago small" date="2021-12-23 05:13:00 +0800" >Dec 23, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>利用因子分析建構投資組合 – 以德國 DAX 指數為例</h3><div class="text-muted small"><p> 相關連結 結果 程式碼 Get data from yahoo finance Slice price and market equity data Get momentum according to formula Set rebalance rule and combine two cut-off portfolio...</p></div></div></a></div><div class="card"> <a href="/coding/finance%20project/JPY-Seasonality/"><div class="card-body"> <em class="timeago small" date="2022-03-13 23:00:00 +0800" >Mar 13, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>日幣的三月季節性 (以 EURJPY 回測)</h3><div class="text-muted small"><p> 三月的日幣季節性 實測結論 EURJPY 回測 (1999-2021) 引入相關套件 (以 dbnomics 套件取得 EURJPY 資料) 自套件取得資料並計算報酬 畫出持有三個交易日的報酬情況 USDJPY 回測 (2017-2021) 附錄 三月的日幣季節性 近期在前大型銀行交易員 Brent Do...</p></div></div></a></div><div class="card"> <a href="/coding/finance%20project/%E5%88%91%E4%BA%8B%E6%A1%88%E4%BB%B6%E7%99%BC%E7%94%9F%E5%8E%9F%E5%9B%A0%E6%8E%A2%E8%A8%8E-%E4%BB%A5%E5%8F%B0%E4%B8%AD%E5%B8%82%E7%82%BA%E4%BE%8B/"><div class="card-body"> <em class="timeago small" date="2021-01-12 10:10:00 +0800" >Jan 12, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>刑事案件發生原因探討-以台中市為例</h3><div class="text-muted small"><p> 相關連結 摘要 程式碼 相關連結 pdf 檔案 Github Repo 摘要 本文主要探討台中市刑事犯罪的可能因素，並以 Becker 的主觀預期效用理論解 釋民眾犯案的可能原因。 本文採用 1995-2019 年台灣台中市之官方統計資料為分析數據，並以 OLS 線性 模型分析，且確認數據並無異質變異數或多元共線性的問題。 實證結果顯示:民眾持有非法器械如...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/macroeconomics/fx/GritFX-VOL53/" class="btn btn-outline-primary" prompt="Older"><p>GritFX Vol. 53 (Super Central Bank Week)</p></a> <a href="/python/%E8%87%AA%E5%8B%95%E5%8C%96/%E8%87%AA%E5%8B%95%E6%8A%93%E5%8F%96%E6%9C%9F%E4%BA%A4%E6%89%80%E9%81%B8%E6%93%87%E6%AC%8A%E8%B3%87%E6%96%99/" class="btn btn-outline-primary" prompt="Newer"><p>用 Python 自動抓取期交所選擇權數據</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/LLH07">Lung Hung Lin</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/gritfx/">GritFX</a> <a class="post-tag" href="/tags/backtest/">Backtest</a> <a class="post-tag" href="/tags/webscrape/">WebScrape</a> <a class="post-tag" href="/tags/econometrics/">Econometrics</a> <a class="post-tag" href="/tags/factor-investing/">Factor Investing</a> <a class="post-tag" href="/tags/jupyter-notebook/">Jupyter Notebook</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/seasonality/">Seasonality</a> <a class="post-tag" href="/tags/tabf/">TABF</a> <a class="post-tag" href="/tags/visualization/">Visualization</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-FDCVZBBR58"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-FDCVZBBR58'); }); </script>
